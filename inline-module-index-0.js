const t=(t,e=0,o=1)=>t>o?o:t<e?e:t,e=(t,e=0,o=Math.pow(10,e))=>Math.round(o*t)/o,o=({h:t,s:o,v:r,a:a})=>{const s=(200-o)*r/100;return{h:e(t),s:e(s>0&&s<200?o*r/100/(s<=100?s:200-s)*100:0),l:e(s/2),a:e(a,2)}},r=t=>{const{h:e,s:r,l:a}=o(t);return`hsl(${e}, ${r}%, ${a}%)`},a=t=>{const{h:e,s:r,l:a,a:s}=o(t);return`hsla(${e}, ${r}%, ${a}%, ${s})`},s=(t,e)=>{if(t===e)return!0;for(const o in t)if(t[o]!==e[o])return!1;return!0},n={},i=t=>{let e=n[t];return e||(e=document.createElement("template"),e.innerHTML=t,n[t]=e),e},l=(t,e,o)=>{t.dispatchEvent(new CustomEvent(e,{bubbles:!0,detail:o}))};let c=!1;const h=t=>"touches"in t,d=(e,o)=>{const r=h(o)?o.touches[0]:o,a=e.el.getBoundingClientRect();l(e.el,"move",e.getMove({x:t((r.pageX-(a.left+window.pageXOffset))/a.width),y:t((r.pageY-(a.top+window.pageYOffset))/a.height)}))};class u{constructor(t,e,o,r){const a=i(`<div role="slider" tabindex="0" part="${e}" ${o}><div part="${e}-pointer"></div></div>`);t.appendChild(a.content.cloneNode(!0));const s=t.querySelector(`[part=${e}]`);s.addEventListener("mousedown",this),s.addEventListener("touchstart",this),s.addEventListener("keydown",this),this.el=s,this.xy=r,this.nodes=[s.firstChild,s]}set dragging(t){const e=t?document.addEventListener:document.removeEventListener;e(c?"touchmove":"mousemove",this),e(c?"touchend":"mouseup",this)}handleEvent(t){switch(t.type){case"mousedown":case"touchstart":if(t.preventDefault(),!(t=>!(c&&!h(t)||(c||(c=h(t)),0)))(t)||!c&&0!=t.button)return;d(this,t),this.dragging=!0;break;case"mousemove":case"touchmove":t.preventDefault(),d(this,t);break;case"mouseup":case"touchend":this.dragging=!1;break;case"keydown":((t,e)=>{const o=e.keyCode;o>40||t.xy&&o<37||o<33||(e.preventDefault(),l(t.el,"move",t.getMove({x:39===o?.01:37===o?-.01:34===o?.05:33===o?-.05:35===o?1:36===o?-1:0,y:40===o?.01:38===o?-.01:0},!0)))})(this,t)}}style(t){t.forEach(((t,e)=>{for(const o in t)this.nodes[e].style.setProperty(o,t[o])}))}}class p extends u{constructor(t){super(t,"hue",'aria-label="Hue" aria-valuemin="0" aria-valuemax="360"',!1)}update({h:t}){this.h=t,this.style([{left:t/360*100+"%",color:r({h:t,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuenow",`${e(t)}`)}getMove(e,o){return{h:o?t(this.h+360*e.x,0,360):360*e.x}}}class g extends u{constructor(t){super(t,"saturation",'aria-label="Color"',!0)}update(t){this.hsva=t,this.style([{top:100-t.v+"%",left:`${t.s}%`,color:r(t)},{"background-color":r({h:t.h,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuetext",`Saturation ${e(t.s)}%, Brightness ${e(t.v)}%`)}getMove(e,o){return{s:o?t(this.hsva.s+100*e.x,0,100):100*e.x,v:o?t(this.hsva.v-100*e.y,0,100):Math.round(100-100*e.y)}}}const f=Symbol("same"),b=Symbol("color"),v=Symbol("hsva"),m=Symbol("change"),x=Symbol("update"),y=Symbol("parts"),w=Symbol("css"),$=Symbol("sliders");class k extends HTMLElement{constructor(){super();const t=i(`<style>${this[w].join("")}</style>`),e=this.attachShadow({mode:"open"});e.appendChild(t.content.cloneNode(!0)),e.addEventListener("move",this),this[y]=this[$].map((t=>new t(e)))}static get observedAttributes(){return["color"]}get[w](){return[':host{display:flex;flex-direction:column;position:relative;width:200px;height:200px;user-select:none;-webkit-user-select:none;cursor:default}:host([hidden]){display:none !important}[role=slider]{position:absolute;left:0;top:0;width:100%;height:100%;touch-action:none;user-select:none;-webkit-user-select:none;outline:none}[role=slider]:last-child{border-radius:0 0 8px 8px}[part$=pointer]{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%, -50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}[part$=pointer]::after{display:block;content:"";position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;background-color:currentColor}[role=slider]:focus [part$=pointer]{transform:translate(-50%, -50%) scale(1.1)}',"[part=hue]{position:relative;bottom:0;left:0;right:0;flex:0 0 24px;background:linear-gradient(to right, #f00 0%, #ff0 17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%)}[part=hue-pointer]{top:50%;z-index:2}","[part=saturation]{display:block;position:relative;flex-grow:1;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(to top, #000, rgba(0, 0, 0, 0)),linear-gradient(to right, #fff, rgba(255, 255, 255, 0));box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}[part=saturation-pointer]{z-index:3}"]}get[$](){return[g,p]}get color(){return this[b]}set color(t){if(!this[f](t)){const e=this.colorModel.toHsva(t);this[x](e),this[m](t)}}connectedCallback(){if(this.hasOwnProperty("color")){const t=this.color;delete this.color,this.color=t}else this.color||(this.color=this.colorModel.defaultColor)}attributeChangedCallback(t,e,o){const r=this.colorModel.fromAttr(o);this[f](r)||(this.color=r)}handleEvent(t){const e=this[v],o={...e,...t.detail};let r;this[x](o),s(o,e)||this[f](r=this.colorModel.fromHsva(o))||this[m](r)}[f](t){return this.color&&this.colorModel.equal(t,this.color)}[x](t){this[v]=t,this[y].forEach((e=>e.update(t)))}[m](t){this[b]=t,l(this,"color-changed",{value:t})}}class M extends u{constructor(t){super(t,"alpha",'aria-label="Alpha" aria-valuemin="0" aria-valuemax="1"',!1)}update(t){this.hsva=t;const o=a({...t,a:0}),r=a({...t,a:1}),s=100*t.a;this.style([{left:`${s}%`,color:a(t)},{"--gradient":`linear-gradient(90deg, ${o}, ${r}`}]);const n=e(s);this.el.setAttribute("aria-valuenow",`${n}`),this.el.setAttribute("aria-valuetext",`${n}%`)}getMove(e,o){return{a:o?t(this.hsva.a+e.x):e.x}}}class C extends k{get[w](){return[...super[w],'[part=alpha]{position:relative;flex:0 0 24px;background-color:#fff}[part=alpha]::after{display:block;content:"";position:absolute;top:0;left:0;right:0;bottom:0;border-radius:inherit;background-image:var(--gradient);box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}[part^=alpha]{background-color:#fff;background-image:url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><rect x="8" width="8" height="8"/><rect y="8" width="8" height="8"/></svg>\')}[part=alpha-pointer]{top:50%}']}get[$](){return[...super[$],M]}}const E={defaultColor:{r:0,g:0,b:0,a:1},toHsva:({r:t,g:o,b:r,a:a})=>{const s=Math.max(t,o,r),n=s-Math.min(t,o,r),i=n?s===t?(o-r)/n:s===o?2+(r-t)/n:4+(t-o)/n:0;return{h:e(60*(i<0?i+6:i)),s:e(s?n/s*100:0),v:e(s/255*100),a:a}},fromHsva:({h:t,s:o,v:r,a:a})=>{t=t/360*6,o/=100,r/=100;const s=Math.floor(t),n=r*(1-o),i=r*(1-(t-s)*o),l=r*(1-(1-t+s)*o),c=s%6;return{r:e(255*[r,i,n,n,l,r][c]),g:e(255*[l,r,r,i,n,n][c]),b:e(255*[n,n,l,r,r,i][c]),a:e(a,2)}},equal:s,fromAttr:t=>JSON.parse(t)};class S extends C{get colorModel(){return E}}customElements.define("rgba-color-picker",class extends S{});const L=()=>{const t=document.createElement("canvas");return t.width=64,t.height=64,t};let A,P,H;const D=t=>(P||(P=L(),H=(()=>{const t=L(),e=t.getContext("2d");return e.beginPath(),e.arc(32,32,28,0,2*Math.PI,!1),e.closePath(),e.shadowColor="rgba(0, 0, 0, 0.4)",e.shadowOffsetY=1,e.shadowBlur=6,e.fillStyle="#fff",e.fill(),t})()),function(t,e,o,r){var a,s=!1,n=0;function i(){a&&clearTimeout(a)}function l(){for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];var d=this,u=Date.now()-n;function p(){n=Date.now(),o.apply(d,c)}function g(){a=void 0}s||(r&&!a&&p(),i(),void 0===r&&u>t?p():!0!==e&&(a=setTimeout(r?g:p,void 0===r?t-u:t)))}return"boolean"!=typeof e&&(r=o,o=e,e=void 0),l.cancel=function(){i(),s=!0},l}(500,(()=>{if(!(window.innerWidth<768&&A)){const e=P.getContext("2d");e.clearRect(0,0,64,64),e.drawImage(H,0,0),e.beginPath(),e.arc(32,32,22,0,2*Math.PI,!1),e.closePath(),e.fillStyle=t,e.fill();const o=document.createElement("link");o.rel="shortcut icon",o.href=P.toDataURL("image/x-icon"),A&&document.head.removeChild(A),document.head.appendChild(o),A=o}}))),O=document.querySelector("rgba-color-picker");O.addEventListener("color-changed",(t=>{const e=t.detail.value,o=`rgba(${e.r}, ${e.g}, ${e.b}, ${e.a})`;document.body.style.backgroundColor=o;const r=(({r:t,g:e,b:o})=>(299*t+587*e+114*o)/1e3)(e)>128||e.a<.5?"#000":"#fff";document.body.style.setProperty("--contrast",r),D(o)()}));O.color=(()=>{const t=[{r:209,g:97,b:28,a:1},{r:30,g:136,b:229,a:1},{r:102,g:51,b:153,a:1},{r:21,g:139,b:59,a:1},{r:189,g:60,b:60,a:1}];return t[Math.floor(Math.random()*t.length)]})();
